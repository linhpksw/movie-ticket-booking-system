@page "/Login"
@inject NavigationManager NavigationManager
@inject HttpClient HttpClient
@using System.Diagnostics
@using G5_MovieTicketBookingSystem.DTOs.UserDto
@code {
    private string email { get; set; } = string.Empty;
    private string password { get; set; } = string.Empty;
    private bool isLoading { get; set; } = false;
    private bool rememberMe { get; set; } = true;
    private string errorMessage { get; set; } = string.Empty;

    private async Task HandleLogin()
    {
        errorMessage = "An error occurred during login";
        try
        {
            isLoading = true;
            errorMessage = string.Empty;

            // Basic validation
            if (string.IsNullOrWhiteSpace(email) || string.IsNullOrWhiteSpace(password))
            {
                errorMessage = "Please fill in all required fields";
                return;


            }
            UserRequestDto loginRequestDto = new()
                {
                    Email = email,
                    Password = password,

                };
  
            Debug.WriteLine($"Login attempt - Email: {email}");

           

            // Example API call (uncomment and modify according to your API)
            /*
            var loginModel = new { Email = email, Password = password, RememberMe = rememberMe };
            var response = await HttpClient.PostAsJsonAsync("api/auth/login", loginModel);

            if (response.IsSuccessStatusCode)
            {
                // Successful login
                Debug.WriteLine("Login successful");
                NavigationManager.NavigateTo("/dashboard"); // Redirect to dashboard or home
                }
            else
            {
                errorMessage = "Invalid email or password";
                Debug.WriteLine($"Login failed: {response.StatusCode}");
                }
            */

                            // Temporary simulation (remove this when implementing real API)
                            await Task.Delay(1000); // Simulate network delay
            if (email.Contains("@") && password.Length >= 6) // Simple validation
            {
                Debug.WriteLine("Login successful (simulation)");
                NavigationManager.NavigateTo("/dashboard");
            }
            else
            {
                errorMessage = "Invalid email or password";
            }
        }
        catch (Exception ex)
        {
            errorMessage = "An error occurred during login";
            Debug.WriteLine($"Login error: {ex.Message}");
        }
        finally
        {
            isLoading = false;
        }
    }

}

<!-- ==========Preloader========== -->
<!-- ==========Sign-In-Section========== -->
<section class="account-section bg_img" data-background="./assets/images/account/account-bg.jpg">
    <div class="container">
        <div class="padding-top padding-bottom">
            <div class="account-area">
                <div class="section-header-3">
                    <span class="cate">hello</span>
                    <h2 class="title">welcome back</h2>
                </div>

                @if (!string.IsNullOrEmpty(errorMessage))
                {
                    <div class="alert alert-danger">@errorMessage</div>
                }
                <form class="account-form" @onsubmit="HandleLogin">
                    <div class="form-group">
                        <label for="email2">Email<span>*</span></label>
                        <input type="text" placeholder="Enter Your Email" id="email2" @bind="email" required>
                    </div>
                    <div class="form-group">
                        <label for="pass3">Password<span>*</span></label>
                        <input type="password" placeholder="Password" id="pass3" @bind="password" required>
                    </div>
                    <div class="form-group checkgroup">
                        <input type="checkbox" id="bal2" @bind="rememberMe">
                        <label for="bal2">remember password</label>
                        <a href="#0" class="forget-pass">Forget Password</a>
                    </div>

                    <div class="form-group text-center">
                        <button type="submit" disabled="@isLoading">
                            @(isLoading ? "Logging in..." : "Log in")
                        </button>
                    </div>
                </form>
                <div class="option">
                    Don't have an account? <a href="/SignUp">sign up now</a>
                </div>
                <div class="or"><span>Or</span></div>
                <ul class="social-icons">
                    <li>
                        <a href="#0">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                    </li>
                    <li>
                        <a href="#0" class="active">
                            <i class="fab fa-twitter"></i>
                        </a>
                    </li>
                    <li>
                        <a href="#0">
                            <i class="fab fa-google"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>

